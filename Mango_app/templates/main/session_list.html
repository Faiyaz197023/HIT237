{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Your Past Records</title>
  <link rel="stylesheet" href="{% static 'css/session_list.css' %}">
</head>
<body>
  <nav>
    {% include 'main/nav.html' %}
  </nav>

  <a href="javascript:history.back()" class="back-btn">‚Üê Go Back</a>

  {% if sessions %}
    <div class="cards">
      {% for s in sessions %}
        <div class="card">
          <a href="{% url 'session-delete' s.id %}"
             class="delete-btn"
             onclick="return confirm('Are you sure you want to delete this record?');">
            Delete
          </a>

          <h2>{{ s.property_name }}</h2>
          <p><strong>Location:</strong> {{ s.location }}</p>
          <p><strong>When:</strong> {{ s.date_time|date:"M d, Y H:i" }}</p>
          <p><strong>Pest/Disease:</strong> {{ s.pest_disease }}</p>
          <p><strong>Part:</strong> {{ s.plant_part }}</p>
          <p>
            <strong>Inspected:</strong>
            {{ s.number_surveyed }} / {{ s.number_plants }}
            ({{ s.pct_inspected }}%)
          </p>
          <p>
            <strong>Duration:</strong>
            {{ s.duration_minutes }} min
            ({{ s.mins_per_plant }} min/plant)
          </p>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="empty">
      No records yet. <a href="{% url 'session-create' %}">Create one</a>.
    </p>
  {% endif %}


  {% if analyzed_images %}
    <h1 style="margin-top:2rem;">Your Analyzed Images</h1>
    <div class="cards">
      {% for ai in analyzed_images %}
        <div class="card">
          <a href="{% url 'analyzed-delete' ai.id %}"
             class="delete-btn"
             onclick="return confirm('Delete this analysis?');">
            Delete
          </a>

          <p><strong>When:</strong> {{ ai.created_at|date:"M d, Y H:i" }}</p>
          <img src="{{ ai.upload.image.url }}"
               alt="Analyzed"
               style="max-width:100%; border-radius:4px; margin:0.5rem 0;">
          <p><strong>Result:</strong> {{ ai.label }}</p>
        </div>
      {% endfor %}
    </div>
  {% endif %}

</body>
</html>
